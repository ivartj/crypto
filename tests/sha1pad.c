/* Using example provided in RFC 3174 */

#include "../crypto.c"
#include <stdlib.h>
#include <assert.h>
#include <stdint.h>
#include <string.h>

char msg[] = { 0x61, 0x62, 0x63, 0x64, 0x65 };

char expected[] = { 0x61, 0x62, 0x63, 0x64, 0x65, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x28 };

void printhexcomparison(char *exp, char *out, size_t len)
{
	int i, j;
	char *iter;

	for(i = 0; i < len; i += 16) {
		for(iter = out; ; iter = exp) {
			for(j = i; j < i + 16; j++)
				printf("%hh.2X", iter[j]);
			puts("");
			
			if(iter == exp) break;
		}
		puts("");
	}
}

int main(int argc, char *argv[])
{
	char *out;
	size_t len;

	out = sha1pad(msg, sizeof(msg), &len);

	printf("%d = %d\n", len, sizeof(expected));
	assert(len == sizeof(expected));

	printhexcomparison(out, expected, len);
	assert(memcmp(out, expected, len) == 0);

	exit(EXIT_SUCCESS);
}
